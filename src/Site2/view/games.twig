{% extends "layout.twig" %}

{% block content %}
    <h2>{{ h1_title }}</h2>

    <div class="category-filter">
        <a href="/games" class="btn-filter {% if not currentCategory %}active{% endif %}">Tous</a>
        {% for category in categories %}
            <a href="/games?category={{ category.id }}" class="btn-filter {% if currentCategory == category.id %}active{% endif %}">{{ category.name }}</a>
        {% endfor %}
    </div>

    <div class="game-grid">
    {% for game in games %}
        <div class="game-card">
            {% include 'components/card.twig' with {
                'card_link': "/game/#{game.id}",
                'card_title': game.title,
                'card_text': game.description,
                'card_image': game.image_url,
                'card_price': game.price,
                'button_basket': true
            } %}
           
        </div>
    {% else %}
        <p>Aucun jeu trouvé.</p>
    {% endfor %}
    </div>

    <div class="pagination">
        {% if currentPage > 1 %}
            <a href="/games?page={{ currentPage - 1 }}{% if currentCategory %}&category={{ currentCategory }}{% endif %}" class="btn-page">Précédent</a>
        {% endif %}
        
        {% for i in 1..totalPages %}
            <a href="/games?page={{ i }}{% if currentCategory %}&category={{ currentCategory }}{% endif %}" class="btn-page {% if currentPage == i %}active{% endif %}">{{ i }}</a>
        {% endfor %}
        
        {% if currentPage < totalPages %}
            <a href="/games?page={{ currentPage + 1 }}{% if currentCategory %}&category={{ currentCategory }}{% endif %}" class="btn-page">Suivant</a>
        {% endif %}
    </div>
{% endblock %}
